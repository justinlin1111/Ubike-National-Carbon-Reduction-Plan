# Ubike-National-Carbon-Reduction-Plan

本研究希望透過深度學習預測每天某些地點的最佳需求量，並且利用基因演算法(GA)來產出一個好的調度策略

1. 查看歷史數據，並且抓出適合的因子
2. 利用(1)抓出的因子以一年以上的數據生成模型，因為只需要預測當下的下一個小時，因此可以使用CNN+LSTM/MLP(多層感知機)
3. 利用此模型預測出需求量(每個站點在哪些因素下會有一個最好的值)
4. 得到需求量後將數據變成可以應用於基因演算法的形式導入得到調度結果(應為一個陣列，並且所代表的值中，正的表示車子太少了，需要有人調度進來；負的表示車子太多了，需要調度出去)

## 需要的因子?
月份、星期幾、小時、站點
## 基因演算法的input形式?

# 目前的問題

1. 基因演算法中的fitness要重新設計(但具體要怎麼重新設計忘了，要再想)
2. getter要做成一個函式，但需要拿的東西取決於機器學習時需要的因子，
輸入參數應該是沒有，輸出結果是抓取的結果(csv/pandas)，取決於機器學習怎麼使用比較方便
3. exception沒用到
4. 現有的資料只能知道目前車站的車輛數，即缺車或滿車，無法得知需求量(可以利用車輛變動量作為需求量近似值，不過可能有公司補車的影響，因此可能需要先做出一個判斷是不是補車的操作，所以可能需要先做一個模型判斷，並且搭配實地去觀察得知?但也很麻煩)
5. 或者需求量根據車輛多於一半跟少於一半直接做一個假設，例如:如果車輛總數比車柱總數的一半多，那我就會希望需求量會是車柱總數的30%(需要把車拿走)，反過來的話希望需求量是車柱總數的70%(需要把車拿來)

# 過去的問題
1. 基因演算法中需要自訂class的Station陣列才能演算，即[Station1,Station2,...,StationN]
因為這個是可能可以減少的變數，看有沒有辦法可以不用另外做出這個「class組成的變數」直接得到數據的方法?
(在getter中拿到的資料可以弄成pandas或csv，但不知道在機器學習之後會是怎樣的型態)，  
A:因為只有要讀資料，所以不需要額外使用東西操作，只要讀取csv即可

# reminder
1. allocation > 0 是需要移出。

# 5/11討論
1. 需要filter，把要討論的點抓出來
2. 討論某個時刻要怎麼運車輛，取整之後抓數值出來丟GA，可能會有總和不是0的情況發生(可能多車了直接說多車，少車就說要運去哪)
3. DNN, RNN
4. 

# 第一步
將原始資料變成可以預測的格式
# 第二步
寫出訓練的通用形式與所有的config
# 第三步
寫出預測的通用形式
# 第四步
把預測完的結果放到GA得到結果

# 注意
這個檔案在執行時需要使用以下格式:
不用.py
python -m 目錄.想要跑的程式碼(-m是從根目錄去看所有的檔案，所以在寫的時候如果有引用到其他的檔案只要從根目錄去往下找就好)
ex:
1. python -m src.1_prepare_data
2. python -m src.predict.predict_dnn


# 新增模型的步驟
1. 在train資料夾下新增(train_模型.py)，參數要是(df_long, ModelConfig.模型_PARAMS)，同時在config.py新增必要的參數
2. 在predict資料夾下新增(predict_模型.py)，參數要是(timestamp_str, station_name)
3. 儲存模型時，需要把他放到model 資料夾中，並且做一個新的資料夾(lamodel_information_模型)，存放模型的檔案
4. 除了config.py以外，所有的模型名稱都用小寫